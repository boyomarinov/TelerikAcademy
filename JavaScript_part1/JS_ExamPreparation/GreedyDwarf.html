<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>4 Feb 2013 - Greedy Dwarf</title>
</head>
<script>
    function Solve(args) {
        var field = args[0].split(", ");
        for (var i = 0; i < field.length; i++) {
            field[i] = parseInt(field[i]);
        }
        var patternsCount = parseInt(args[1]);

        var maxSum = Number.MIN_VALUE;
        for (var i = 0; i < patternsCount; i++) {
            var currentPattern = args[2 + i].split(", ");
            for (var j = 0; j < currentPattern.length; j++) {
                currentPattern[j] = parseInt(currentPattern[j]);
            }

            var stepIndex = 0;
            var sum = 0;
            var fieldIndex = 0;
            var visited = {};

            while (fieldIndex >= 0 && fieldIndex < field.length && visited[fieldIndex] != true) {
                sum += field[fieldIndex];
                visited[fieldIndex] = true;
                fieldIndex = fieldIndex + currentPattern[stepIndex];
                stepIndex++;

                if (stepIndex == currentPattern.length) {
                    stepIndex = 0;
                }
            }

            if (maxSum < sum) {
                maxSum = sum;
            }
        }
        return maxSum;
    }

    function TestIO() {
        var args = [];
        args[0] = "1, 3, -6, 7, 4, 1, 12";
        args[1] = "3";
        args[2] = "1, 2, -3";
        args[3] = "1, 3, -2";
        args[4] = "1, -1";
        console.log(Solve(args));
    }
</script>
<body onload="TestIO()">
</body>
</html>
